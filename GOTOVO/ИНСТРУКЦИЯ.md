# Инструкция по установке и запуску бота для обмена криптовалюты

## Содержание
1. [Установка на Windows](#установка-на-windows)
2. [Установка на Ubuntu](#установка-на-ubuntu)
3. [Настройка бота](#настройка-бота)
4. [Обслуживание](#обслуживание)
5. [Устранение неполадок](#устранение-неполадок)

## Установка на Windows

### Необходимые компоненты
1. **Python 3.8+**
   - Скачайте Python с официального сайта: https://www.python.org/downloads/
   - При установке обязательно отметьте опцию "Add Python to PATH"

### Шаги установки
1. **Распакуйте архив с ботом** в удобное место на вашем компьютере.

2. **Установите зависимости**:
   - Откройте командную строку (cmd) от имени администратора
   - Перейдите в распакованную папку с ботом:
     ```
     cd путь\к\папке\с\ботом
     ```
   - Установите необходимые библиотеки:
     ```
     pip install -r requirements.txt
     ```

3. **Настройте токен бота**:
   - Откройте файл `config.json` в любом текстовом редакторе
   - Замените значение "token" на ваш токен от BotFather
   - Укажите ID администраторов в разделе "admin_ids"

4. **Запустите бота**:
   - Дважды кликните на файл `start_bot.bat` или запустите из командной строки:
     ```
     start_bot.bat
     ```

## Установка на Ubuntu

### Необходимые компоненты
1. **Python 3.8+** и инструменты разработки:
   ```bash
   sudo apt update
   sudo apt install python3 python3-pip python3-venv git
   ```

### Шаги установки
1. **Скопируйте файлы бота** на сервер:
   ```bash
   mkdir -p ~/crypto_bot
   # Скопируйте файлы в эту папку
   ```

2. **Создайте виртуальное окружение** (опционально, но рекомендуется):
   ```bash
   cd ~/crypto_bot
   python3 -m venv venv
   source venv/bin/activate
   ```

3. **Установите зависимости**:
   ```bash
   pip install -r requirements.txt
   ```

4. **Настройте бота**:
   - Отредактируйте config.json:
     ```bash
     nano config.json
     ```
   - Измените токен бота и ID администраторов

5. **Сделайте скрипт запуска исполняемым**:
   ```bash
   chmod +x start_bot.sh
   ```

6. **Запустите бота**:
   ```bash
   ./start_bot.sh
   ```

7. **Настройка автозапуска** (опционально):
   - Создайте systemd сервис:
     ```bash
     sudo nano /etc/systemd/system/crypto_bot.service
     ```
   - Добавьте следующую конфигурацию:
     ```
     [Unit]
     Description=Telegram Crypto Exchange Bot
     After=network.target

     [Service]
     User=YOUR_USERNAME
     WorkingDirectory=/home/YOUR_USERNAME/crypto_bot
     ExecStart=/home/YOUR_USERNAME/crypto_bot/venv/bin/python main.py
     Restart=always
     RestartSec=10

     [Install]
     WantedBy=multi-user.target
     ```
   - Замените YOUR_USERNAME на имя вашего пользователя
   - Активируйте и запустите сервис:
     ```bash
     sudo systemctl enable crypto_bot
     sudo systemctl start crypto_bot
     ```
   - Проверьте статус:
     ```bash
     sudo systemctl status crypto_bot
     ```

## Настройка бота

### Основные настройки
1. **Конфигурационный файл** `config.json` содержит:
   - `token`: Токен вашего бота от BotFather
   - `admin_ids`: Список ID администраторов бота
   - `rates`: Курсы обмена валют
   - `min_amount`: Минимальная сумма сделки
   - `currencies`: Настройки поддерживаемых валют

2. **Изменение курсов обмена**:
   - Можно изменить через файл `config.json`
   - Или через административный интерфейс бота

3. **Добавление поддерживаемых валют**:
   - Через административный интерфейс в Telegram
   - Или напрямую в `config.json`

### Настройка реферальной системы
Реферальная система настраивается в разделе `referral` в файле `config.json`. Вы можете изменить уровни и проценты вознаграждения.

## Обслуживание

### Регулярные задачи
1. **Проверка логов**:
   - На Windows: Проверьте консоль бота
   - На Ubuntu: `journalctl -u crypto_bot -f`

2. **Резервное копирование данных**:
   - Регулярно копируйте папку `data` для сохранения информации о пользователях и заявках

3. **Обновление курсов**:
   - Регулярно обновляйте курсы обмена через админ-панель или в config.json

### Обновление бота
1. Остановите бота
2. Сделайте резервную копию папки `data` и файла `config.json`
3. Замените файлы бота на новые
4. Верните `config.json` и папку `data`
5. Запустите бота снова

## Устранение неполадок

### Типичные проблемы
1. **Бот не запускается**:
   - Проверьте правильность установки Python
   - Проверьте, что все зависимости установлены
   - Убедитесь, что токен бота действителен

2. **Не работают кнопки**:
   - Проверьте, что нет циклических импортов в коде
   - Убедитесь, что все обработчики кнопок правильно зарегистрированы

3. **Проблемы с авторизацией администраторов**:
   - Проверьте, что ID администраторов правильно указаны в config.json

4. **Потеря данных**:
   - Регулярно делайте резервные копии папки `data`
   - При необходимости восстановите из бэкапа

### Запуск бота в режиме отладки
Добавьте в начало файла `main.py` следующие строки для включения детальных логов:
```python
import logging
logging.basicConfig(level=logging.DEBUG)
```

### Контакты для поддержки
Если у вас возникли проблемы, которые вы не можете решить самостоятельно, свяжитесь с разработчиком.